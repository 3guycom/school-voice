import{b as v,R as r,j as e,L as p,s as u}from"./index-JDxZcwZg.js";import{C as S}from"./circle-alert-B391DCOR.js";import{M as C}from"./mail-CUcBglu-.js";import{L as R}from"./lock-UNwzH9jp.js";import{B as D}from"./book-open-B2jTp5xz.js";import"./createLucideIcon-YQMw5vR1.js";const E=()=>{const b=v(),[a,w]=r.useState({email:"",password:""}),[o,x]=r.useState(!1),[i,d]=r.useState(""),[g,l]=r.useState(""),[n,j]=r.useState(!1),[h,c]=r.useState(""),f=m=>{const{name:s,value:t}=m.target;w(y=>({...y,[s]:t})),i&&(d(""),l(""))},N=async m=>{m.preventDefault(),x(!0),d(""),l(""),c("Creating your account...");try{await u.auth.signOut();const{data:s,error:t}=await u.auth.signUp({email:a.email,password:a.password,options:{emailRedirectTo:`${window.location.origin}/login`}});if(t)throw console.error("❌ User creation error:",t),t.message==="User already registered"||(t==null?void 0:t.code)==="user_already_exists"?new Error("This email is already registered. Please sign in instead or use a different email address."):new Error(`Failed to create user account: ${t.message}`);if(!s.user)throw console.error("❌ No user data returned"),new Error("User account could not be created");console.log("✅ User created successfully with ID:",s.user.id),c("Registration successful!"),setTimeout(()=>{b("/create-school",{state:{message:"Account created successfully! Now let's set up your school."}})},1500)}catch(s){console.error("❌ Registration error:",s),d(s.message||"Registration failed. Please try again."),s instanceof Error?l(s.stack||s.message):l(JSON.stringify(s)),c(""),await u.auth.signOut()}finally{x(!1)}};return e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[i&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex",children:[e.jsx(S,{className:"h-5 w-5 text-red-400 mr-2"}),e.jsx("p",{className:"text-sm font-medium text-red-800",children:i})]}),i.includes("already registered")&&e.jsx("div",{className:"mt-2 pl-7",children:e.jsx(p,{to:"/login",className:"text-sm font-medium text-red-700 hover:text-red-900",children:"Go to login page →"})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("button",{type:"button",onClick:()=>j(!n),className:"text-xs text-red-700 underline",children:n?"Hide details":"Show technical details"}),n&&g&&e.jsx("pre",{className:"mt-2 text-xs bg-red-50 p-2 rounded overflow-auto max-h-[200px]",children:g})]})]}),h&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-3",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-blue-600"})}),e.jsx("p",{className:"text-sm font-medium text-blue-800",children:h})]})}),e.jsxs("form",{className:"space-y-6",onSubmit:N,children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"flex items-center text-sm font-medium text-gray-700",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),"Email address"]}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a.email,onChange:f,disabled:o,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"})})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"flex items-center text-sm font-medium text-gray-700",children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),"Password"]}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:a.password,onChange:f,disabled:o,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400",children:o?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white mr-2"}),"Processing..."]}):"Create Account"})})]})]})},O=()=>e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(D,{className:"h-12 w-12 text-indigo-600"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create Your Account"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"First, let's set up your account. Then you'll create your school."})]}),e.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx(E,{}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("span",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(p,{to:"/login",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Sign in"})]})})]})]});export{O as default};
